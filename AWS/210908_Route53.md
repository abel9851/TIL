# Route53이란

[1. 도메인 구입하기](#도메인-구입하기)  

---

DNS를 서비스화 한 것이다.  
이 서비스를 이용하면 도메인 네임을 구입할 수 있고  
구입한 도메인네임과, 또는 이미 가지고 도메인 네임에 IP주소를  
매칭시키는 관리작업을 할 수도 있다.  
특히 Route53은  
AWS의 서버의 성격을 가진, S3, EC2, ELB, CloudFront등과  
쉽게 연동이 된다.  

그리고 고급기능을 이용하면 도메인을 이용해서  
**여러 개의 서비스로 부하를 분산하는**  
**로드밸런싱하는 작업도 저렴하고 쉽게 할수 있다.**  

Route53을 사용하려면 크게 3가지 파트로 나눌 수 있다.

도메인 구입, 구입한 도메인에다가 IP를 연결시켜서 도메인으로 들어오는 사람을 그 IP로 접속 할수 있게 하는것,  
어떤 도메인에 접속했을때 그 도메인의 IP를 클라이언트가 알아내는 것, 


일단, IP가 있으면, 도메인을 사야하는데  
도메인은 등록대행자(Registrar)라는 등록 대행을 해주는 회사를 찾아가서  
example.com이라는 특정 도메인을 사고 싶다고 얘기를 해야한다.  

**바로 Route53이 도메인을 구매해주는 것을 대행해준다. 구매대행업체다**  

- ### 도메인 구입
사고싶다고 얘기를 하면, 구매대행자는 도메인에 끝에 있는  
.com(탑 레벨 도메인), kr 등 탑 레벨 도메인마다  
관리하는 기관이 각각 다른데  
.com의 경우에는 등록소(Registry)가 그것을 담당하는 기관이다.  

등록대행자는 등록소에게 클라이언트가 example.com을 사용하고 싶다고  
말하고 등록소는 수수료를 받고 example.com을 사용할 권리를 클라이언트에게 준다.  


- ### 도메인과 IP연결
도메인의 IP가 무엇인지를 전세계 사람들에게 서비스 하려면  
DNS를 가지고 있어야한다.  
컴퓨터를 장만해서 거기에 DNS 서버를 깔아도 되지만  
DNS서버를 서비스로 제공해주는 회사의 서비스를 써도 된다.  
**Route53은 바로 이런 일도 한다.**  
도메인 네임 서버를 임대해주는 것, Route53의 핵심기능이다.  

도메인 서버를 장만했으면(직접 설정, 혹은 임대),
**거기에 세팅을 하는 것이다.**  
**example.com의 IP는 93.184.216.34라고.**  

**이렇게 등록을 했으면, .com의 등록소(Registry)에게**  
**example.com을 관리하는 도메인네임서버가 a.iana-servers.net라는 것을 알려줘야한다.**  
등록소에 도메인 네임 서버를 알려주는 것 또한 등록대행자가 해준다.  

이렇게 알려주면 등록소가 가지고 있는, 도메인 네임서버(a.gtld-servers.net)에  
example.com의 NS는, a.iana-servers.net이라고 기록해둔다.  
여기까지 하면 등록과정이 끝난다.  

**만약, IP주소가 바뀌었으면, 등록대행자에 등록했던**  
**도메인의 IP주소만 바꿔주면된다.**  

- ### 클라이언트가 도메인에 접속
클라이언트가 인터넷에 접속하기위해  
와이파이에 접속하거나 Lan선을 꼽는 순간에  
통신을 제공하는 사업자가  
클라이언트가 사용할 도메인네임서버를 자동으로 세팅해준다.  

예를 들어 1.1.1.1이라는 IP를 가지고 있는 도메인 네임서버가 세팅되었다고 생각해보자  

그러면 클라이언트는 어떠한 도메인에 접속하려고 하면  
IP를 알아내야하는데  
그 IP를 1.1.1.1이라는 IP를 가지고 있는 도메인 네임 서버에게 물어보게 된다.  
이때 1.1.1.1의 DNS는 example.com의 IP를 모르지만  
제일 먼저 **Root name server**에게 물어보도록 약속되어 있다.  

그리고 Root name server가 누구냐는 것은, 모든 DNS에 적혀있다.(상수로!)  

1.1.1.1 DNS서버는 a.root-servers.net이라는 주소에 해당되는 컴퓨터한테 example.com의 ip를 알려달라고 물어본다.  

a.root-servers.net에 해당하는 RNS 또한 example.com을 모르지만  
.com이라고 하는 등록소(a.gtld-servers.net)가 어떤 네임서버를 운용하는지 알수 있다.  
즉 등록소의 DNS의 주소를 알고 있으므로 example.com에 대해서는  
**a.gtld-servers.net에게 물어보라고 1.1.1.1 DNS서버에게 응답한다.**

그러면 1.1.1.1의 DNS 서버는 등록소(a.gtld-servers.net)에게 example.com의 IP가 뭐냐고 물어보고  
등록대행자의 DNS 서버(a.iana-servers.net)에게 물어보라고 응답한다.  

그러면 1.1.1.1의 DNS 서버는 등록대행자(a.iana-servers.net에 해당하는 DNS서버)에 접속해서  
example.com의 ip가 뭐냐고 물어본다.  
그러면 등록대행자의 DNS 서버는 1.1.1.1이라는 DNS서버에게 example.com의 ip인 93.184.216.34를 응답해주고  
클라이언트는 93.184.216.34를 통해 접속가능하게 된다.

즉 **Route53은 등록대행자와 DNS서버를 임대해주는 것(example.com의 ip는 93.194.216.34라는 것을 기록)이**  
**핵심 기능이다.**  

---

- ## 도메인 구입하기
도메인 구입은 Route53에서 구입하거나 freenom 같은 사이트에서  
도메인을 구입해도 된다.  
일단 freenom은 1년동안  도메인을 무료로 사용할 수 있음으로  
freenom을 사용해서 구입하자.  


- ## 도메인과 IP 연결
도메인의 디버깅은 dig web interface를 사용하면 된다.  
