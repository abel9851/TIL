## TTL(Time To Live)이란

패킷의 생존시간을 의미한다.

인터넷에서 IP패킷이 라우팅되며 남아있는(거쳐야하는) 라우터의 개수를 표한하는 수이다.

패킷이 무한으로 순환하는 것을 막아주는 역할을 한다.

TTL의크기는 최대 255다.

기본값은 64로 할당하지만, 필요시 다른 값도 사용가능하다.

### TTL이 없다면

TTL이 없다면 패킷이 목적지를 찾으려고 네트워크를 돌아다니느데 목적지를 찾지 못한다면 정해진 수명이 존재하지 않아서 계속 네트워크상에 떠돌아다니게 된다.

```bash
A-PC -> 10.120.50.10 ( 임의의 IP )
위와 같이 ping 명령어를 통해서 통신을 시도하는 상황이다.
( 단, 10.120.50.10은 존재하지 않는 IP라고 가정. )
```

### TTL이 있다면

TTL은 라우터와 같은 네트워크 장비를 거칠때마다 값이 1씩 감소한다.

그리고 TTL값이 0이 된다면 패킷이 드랍된다.

Reply를 받을때는 감소되지 않는다.

### DNS에서 TTL

DNS에서 TTL은 타 네임서버가 해당 도메인의 정보(ex. www.codns.com=1.234.567.892)를 메모리 상에 임시 저장하는 시간(캐싱)-도메인 정보의 생존시간-으로 프로그램이나 브라우저에서 도메인을 입력할 경우, 먼저 컴퓨터의 임시 저장된 주소정보에 묻고, 만약 저장정보가 없으면 등록해놓은 DNS를 통하여 주소정보를 받아 IP로 연결하게 되는 것이다.

전용선과 같이 고정IP를 이용하는 도메인의 경우는 TTL값은 최대한 길게 잡는 것이 유리하며(권장값:3600), 유동IP의 경우는 TTL값을 최대한 줄여주는 것이 좋다.(권장값:120)

DNS 쿼리에 대한 결과를 받아갔을 경우 결과값을 캐시에 저장하는 시간을 의미한다.

이것은 DNS서버와 사용자 PC 전부 다 적용된다.

TTL은 다음 레코드 변경사항이 적용될때까지 걸리는 시간(초)을 결정하는 DNS 레코드 값이다.

레코드의 현재 TTL은 변경사항이 적용될때까지 걸리는 시간을 결정한다.

예를 들어 TTL 값이 86400초인 레코드에 대한 변경사항은 적용될때까지 24시간이 소요된다.

PC는 세팅된 네임서버를 통해 IP쿼리를 시도한다.

TTL이 3600초로 설정된 도메인을 최초 커리를 해서 응답값을 가지고 오면, 이 값은 DNS서버나 사용자 PC의 캐시(메모리)에 3600초를 시작으로 매초마다 시간이 감소되다 0이 되면 메모리에서 사라진다.

이렇게 되면 PC가 사용하는 네임서버(지정된)는 처음으로 질문되어진 도메인에 대한 IP주소를 모르기 때문에 최상위 도메인 관리자로부터 지정해준 도메인의 네임서버까지 도메인의 IP쿼리 작업을 진행한다.

이 TTL값을 너무 크게 주면 DNS 서버가 받는 쿼리에 대한 부하는 적어지지만 갱신주기가 느려지기 때문에 IP가 변경되어 DNS에서 수정을 할 경우 전파되는 시간이 길어진다.

반대로 너무 적게 주면 DNS 서버의 부하는 커지는 반면, 전파되는 시가은 짧아진다.

보통 서비스가 되고 있는 도메인의경우 IP변경이 1년에 한두번 있을까 말까하다.

신규 서비스나 서브 도메인 추가나 개발완료후 DNS 연결을 변경하는 작업이나 서버 교체나 증설 등등의 작업이 아니고선 거의 없다.

팁

```
Refresh는 1차와 2차 네임서버가 Zone Transfer 를 이용해 동기화 할 경우 어느 주기마다 동기화를 할지 정해주는 시간입니다.예를 들어 3600초로 설정을 하게되면 1시간마다 동기화를 시도하게 됩니다.RFC1912 에 의한 권장 SOA Refresh Time은 20분~2시간 또는 2시간~12시간 입니다.
인터넷상의 서버가 레코드의 업데이트 사항을 매시간 확인하도록 TTL 값을 3600으로 설정할 것을 권장하는곳이 많습니다.이렇게 하면 향후 레코드를 업데이트할 경우 변경사항이 적용될 때까지 한 시간이 소요됩니다.
보통은 변경 사항이 발생되면 빠른 업데이트를 해야 하기 때문에 IP변경 이벤트 발생시점 TTL 이전에만 30분으로 TTL을 설정하시고변경사항이 더욱 빠르게 적용되도록 하려면 TTL을 300초(5분)와 같이 더 짧게 설정할 수도 있습니다.
IP변경 후 정상적인 서비스가 3일정도 지난 후에는 다시 하루로(TTL 값이 86400초) TTL을 설정을 변경하시는게 좋다고 생각합니다.
뭐 SE가 아닌 개발자의 짧은 지식이므로 영양가 없을 수도 있으나 전 이렇게 진행을 보통 하고 있습니다.

출처:

[https://l2j.co.kr/2767](https://l2j.co.kr/2767)

[L2J with DuraBoys:티스토리]
```

Reference

[TTL이 뭔지 알아보자.](https://velog.io/@rkadl9999/TTL%EC%9D%B4-%EB%AD%94%EC%A7%80-%EC%95%8C%EC%95%84%EB%B3%B4%EC%9E%90)

[네트워크 ] ICMP 란?](https://m.blog.naver.com/PostView.naver?isHttpsRedirect=true&blogId=rbdi3222&logNo=220602423771)

[네임서버에서 TTL(Time To Live)의 개념](https://l2j.co.kr/2767)
